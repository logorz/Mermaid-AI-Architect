"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/gemini/route";
exports.ids = ["app/api/gemini/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgemini%2Froute&page=%2Fapi%2Fgemini%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgemini%2Froute.ts&appDir=%2FUsers%2Fliyuerui%2FTRAE%2FMermaid-AI-Architect%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fliyuerui%2FTRAE%2FMermaid-AI-Architect&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgemini%2Froute&page=%2Fapi%2Fgemini%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgemini%2Froute.ts&appDir=%2FUsers%2Fliyuerui%2FTRAE%2FMermaid-AI-Architect%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fliyuerui%2FTRAE%2FMermaid-AI-Architect&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_liyuerui_TRAE_Mermaid_AI_Architect_src_app_api_gemini_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/gemini/route.ts */ \"(rsc)/./src/app/api/gemini/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/gemini/route\",\n        pathname: \"/api/gemini\",\n        filename: \"route\",\n        bundlePath: \"app/api/gemini/route\"\n    },\n    resolvedPagePath: \"/Users/liyuerui/TRAE/Mermaid-AI-Architect/src/app/api/gemini/route.ts\",\n    nextConfigOutput,\n    userland: _Users_liyuerui_TRAE_Mermaid_AI_Architect_src_app_api_gemini_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/gemini/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnZW1pbmklMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmdlbWluaSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmdlbWluaSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmxpeXVlcnVpJTJGVFJBRSUyRk1lcm1haWQtQUktQXJjaGl0ZWN0JTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmxpeXVlcnVpJTJGVFJBRSUyRk1lcm1haWQtQUktQXJjaGl0ZWN0JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNxQjtBQUNsRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL21lcm1haWQtYWktYXJjaGl0ZWN0Lz9jYzVjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9saXl1ZXJ1aS9UUkFFL01lcm1haWQtQUktQXJjaGl0ZWN0L3NyYy9hcHAvYXBpL2dlbWluaS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZ2VtaW5pL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZ2VtaW5pXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9nZW1pbmkvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbGl5dWVydWkvVFJBRS9NZXJtYWlkLUFJLUFyY2hpdGVjdC9zcmMvYXBwL2FwaS9nZW1pbmkvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2dlbWluaS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgemini%2Froute&page=%2Fapi%2Fgemini%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgemini%2Froute.ts&appDir=%2FUsers%2Fliyuerui%2FTRAE%2FMermaid-AI-Architect%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fliyuerui%2FTRAE%2FMermaid-AI-Architect&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/gemini/route.ts":
/*!*************************************!*\
  !*** ./src/app/api/gemini/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../constants */ \"(rsc)/./src/constants.ts\");\n\n\n// OpenRouter API endpoint\nconst OPENROUTER_API_ENDPOINT = \"https://openrouter.ai/api/v1/chat/completions\";\n// Model to use\nconst MODEL = \"google/gemini-2.5-flash-lite\";\nasync function POST(request) {\n    // Get the origin from the request headers\n    const origin = request.headers.get(\"origin\") || request.headers.get(\"referer\") || \"https://mermaid-ai-architect.vercel.app\";\n    // Check if API key is available\n    if (!process.env.API_KEY) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"API 密钥未配置，请在 .env.local 文件中设置 API_KEY 环境变量。\"\n        }, {\n            status: 500\n        });\n    }\n    try {\n        const { action, ...data } = await request.json();\n        if (action === \"generate\") {\n            const { history, currentCode, diagramType } = data;\n            const result = await generateFromHistory(history, currentCode, diagramType, origin);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n        } else if (action === \"fix\") {\n            const { code, errorMsg } = data;\n            const result = await fixDiagram(code, errorMsg, origin);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n        } else if (action === \"optimize\") {\n            const { prompt } = data;\n            const result = await optimizePrompt(prompt, origin);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n        } else {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"无效的操作类型\"\n            }, {\n                status: 400\n            });\n        }\n    } catch (error) {\n        console.error(\"API 错误:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"处理请求时出现错误\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * Generates Mermaid code or a text response based on chat history.\n */ async function generateFromHistory(history, currentCode, diagramType = \"auto\", origin = \"https://mermaid-ai-architect.vercel.app\") {\n    // Construct the messages for OpenRouter\n    const messages = [];\n    // Add system message\n    messages.push({\n        role: \"system\",\n        content: _constants__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_INSTRUCTION\n    });\n    // Add user and assistant messages\n    history.forEach((msg)=>{\n        // For OpenRouter, text content should be a string, not an object\n        if (msg.content && !msg.attachment) {\n            let textContent = msg.content;\n            // Add context note if this is the last user message\n            if (msg.role === \"user\" && msg === history[history.length - 1]) {\n                let contextNote = \"\";\n                if (currentCode) {\n                    contextNote += `\\n[Context - Current Mermaid Code]:\\n${currentCode}\\n`;\n                }\n                if (diagramType !== \"auto\") {\n                    contextNote += `\\n[Context - User Preferred Type]: ${diagramType}\\n`;\n                }\n                if (contextNote) {\n                    textContent += contextNote;\n                }\n            }\n            messages.push({\n                role: msg.role === \"user\" ? \"user\" : \"assistant\",\n                content: textContent\n            });\n        } else if (msg.attachment) {\n            const content = [];\n            // Add text if present\n            if (msg.content) {\n                content.push({\n                    type: \"text\",\n                    text: msg.content\n                });\n            }\n            // Add attachment based on type\n            if (msg.attachment.mimeType.startsWith(\"image/\") || msg.attachment.mimeType === \"application/pdf\") {\n                // Handle image and PDF attachments\n                const base64Data = msg.attachment.content.includes(\",\") ? msg.attachment.content.split(\",\")[1] : msg.attachment.content;\n                content.push({\n                    type: \"image_url\",\n                    image_url: {\n                        url: `data:${msg.attachment.mimeType};base64,${base64Data}`\n                    }\n                });\n                // Add text description for context\n                content.push({\n                    type: \"text\",\n                    text: `${msg.attachment.mimeType === \"application/pdf\" ? \"[PDF Document]\" : \"[Image]\"}: ${msg.attachment.fileName}\\nPlease analyze this document and generate a Mermaid diagram based on its content.`\n                });\n            }\n            messages.push({\n                role: msg.role === \"user\" ? \"user\" : \"assistant\",\n                content: content\n            });\n        }\n    });\n    try {\n        const response = await fetch(OPENROUTER_API_ENDPOINT, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": `Bearer ${process.env.API_KEY}`,\n                \"HTTP-Referer\": origin,\n                \"X-Title\": \"Mermaid AI Architect\"\n            },\n            body: JSON.stringify({\n                model: MODEL,\n                messages: messages,\n                response_format: {\n                    type: \"json_object\"\n                },\n                temperature: 0.7\n            })\n        });\n        if (!response.ok) {\n            throw new Error(`API error: ${response.status} ${await response.text()}`);\n        }\n        const data = await response.json();\n        const jsonText = data.choices[0].message.content || \"{}\";\n        const result = JSON.parse(jsonText);\n        // Double clean the code if it's code type\n        if (result.type === \"code\") {\n            result.content = cleanCode(result.content);\n        }\n        return result;\n    } catch (error) {\n        console.error(\"OpenRouter Chat Error:\", error);\n        // Fallback response\n        return {\n            type: \"message\",\n            content: \"抱歉，连接 AI 服务时出现错误或超时，请重试。\"\n        };\n    }\n}\n/**\n * Fixes syntax errors in Mermaid code.\n */ async function fixDiagram(code, errorMsg, origin = \"https://mermaid-ai-architect.vercel.app\") {\n    const prompt = `The following Mermaid code has a syntax error.\n    \nError Message: \"${errorMsg}\"\n\nCode:\n${code}\n\nPlease fix the code so it renders correctly. \nReturn the result in JSON format with two fields:\n1. \"code\": The corrected Mermaid code string.\n2. \"explanation\": A single sentence in Chinese explaining what caused the error.\n`;\n    try {\n        const response = await fetch(OPENROUTER_API_ENDPOINT, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": `Bearer ${process.env.API_KEY}`,\n                \"HTTP-Referer\": origin,\n                \"X-Title\": \"Mermaid AI Architect\"\n            },\n            body: JSON.stringify({\n                model: MODEL,\n                messages: [\n                    {\n                        role: \"user\",\n                        content: prompt\n                    }\n                ],\n                response_format: {\n                    type: \"json_object\"\n                },\n                temperature: 0.7\n            })\n        });\n        if (!response.ok) {\n            throw new Error(`API error: ${response.status} ${await response.text()}`);\n        }\n        const data = await response.json();\n        const result = JSON.parse(data.choices[0].message.content || \"{}\");\n        return {\n            code: cleanCode(result.code || code),\n            explanation: result.explanation || \"已修复语法错误。\"\n        };\n    } catch (error) {\n        console.error(\"OpenRouter Fix Error:\", error);\n        throw new Error(\"无法修复图表。\");\n    }\n}\nfunction cleanCode(raw) {\n    let clean = raw.trim();\n    if (clean.startsWith(\"```\")) {\n        clean = clean.replace(/^```(mermaid)?\\n?/, \"\").replace(/```$/, \"\");\n    }\n    clean = clean.trim();\n    // Bottom-layer optimization: \n    // Automatically enforce 'flowchart' over 'graph' for better layout engine stability\n    if (clean.startsWith(\"graph \")) {\n        clean = clean.replace(/^graph /, \"flowchart \");\n    }\n    return clean;\n}\n/**\n * Optimizes a prompt for better Mermaid diagram generation.\n */ async function optimizePrompt(prompt, origin = \"https://mermaid-ai-architect.vercel.app\") {\n    const optimizationPrompt = `Please optimize the following prompt for Mermaid diagram generation. The goal is to make it more clear, specific, and suitable for generating accurate Mermaid diagrams.\n\nOriginal Prompt:\n${prompt}\n\nOptimized Prompt:\n`;\n    try {\n        const response = await fetch(OPENROUTER_API_ENDPOINT, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": `Bearer ${process.env.API_KEY}`,\n                \"HTTP-Referer\": origin,\n                \"X-Title\": \"Mermaid AI Architect\"\n            },\n            body: JSON.stringify({\n                model: MODEL,\n                messages: [\n                    {\n                        role: \"user\",\n                        content: optimizationPrompt\n                    }\n                ],\n                response_format: {\n                    type: \"json_object\"\n                },\n                temperature: 0.7\n            })\n        });\n        if (!response.ok) {\n            throw new Error(`API error: ${response.status} ${await response.text()}`);\n        }\n        const data = await response.json();\n        const optimizedText = data.choices[0].message.content || prompt;\n        return {\n            type: \"message\",\n            content: optimizedText\n        };\n    } catch (error) {\n        console.error(\"OpenRouter Optimization Error:\", error);\n        // Fallback response\n        return {\n            type: \"message\",\n            content: prompt\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q1g7SUFDRixFQUFFLE9BQU96RCxPQUFPO1FBQ2RjLFFBQVFkLEtBQUssQ0FBQyxrQ0FBa0NBO1FBQ2hELG9CQUFvQjtRQUNwQixPQUFPO1lBQ0x5QixNQUFNO1lBQ05QLFNBQVNOO1FBQ1g7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVybWFpZC1haS1hcmNoaXRlY3QvLi9zcmMvYXBwL2FwaS9nZW1pbmkvcm91dGUudHM/Njg4YyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgU1lTVEVNX0lOU1RSVUNUSU9OIH0gZnJvbSAnLi4vLi4vLi4vY29uc3RhbnRzJztcbmltcG9ydCB7IERpYWdyYW1UeXBlLCBDaGF0TWVzc2FnZSwgR2VuQUlSZXNwb25zZSB9IGZyb20gJy4uLy4uLy4uL3R5cGVzJztcblxuLy8gT3BlblJvdXRlciBBUEkgZW5kcG9pbnRcbmNvbnN0IE9QRU5ST1VURVJfQVBJX0VORFBPSU5UID0gJ2h0dHBzOi8vb3BlbnJvdXRlci5haS9hcGkvdjEvY2hhdC9jb21wbGV0aW9ucyc7XG4vLyBNb2RlbCB0byB1c2VcbmNvbnN0IE1PREVMID0gJ2dvb2dsZS9nZW1pbmktMi41LWZsYXNoLWxpdGUnO1xuXG4vLyBSZXF1ZXN0IHR5cGVzXG5pbnRlcmZhY2UgR2VuZXJhdGVSZXF1ZXN0IHtcbiAgaGlzdG9yeTogQ2hhdE1lc3NhZ2VbXTtcbiAgY3VycmVudENvZGU/OiBzdHJpbmc7XG4gIGRpYWdyYW1UeXBlOiBEaWFncmFtVHlwZTtcbn1cblxuaW50ZXJmYWNlIEZpeFJlcXVlc3Qge1xuICBjb2RlOiBzdHJpbmc7XG4gIGVycm9yTXNnOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBPcHRpbWl6ZVJlcXVlc3Qge1xuICBwcm9tcHQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgLy8gR2V0IHRoZSBvcmlnaW4gZnJvbSB0aGUgcmVxdWVzdCBoZWFkZXJzXG4gIGNvbnN0IG9yaWdpbiA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ29yaWdpbicpIHx8IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3JlZmVyZXInKSB8fCAnaHR0cHM6Ly9tZXJtYWlkLWFpLWFyY2hpdGVjdC52ZXJjZWwuYXBwJztcbiAgXG4gIC8vIENoZWNrIGlmIEFQSSBrZXkgaXMgYXZhaWxhYmxlXG4gIGlmICghcHJvY2Vzcy5lbnYuQVBJX0tFWSkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IFwiQVBJIOWvhumSpeacqumFjee9ru+8jOivt+WcqCAuZW52LmxvY2FsIOaWh+S7tuS4reiuvue9riBBUElfS0VZIOeOr+Wig+WPmOmHj+OAglwiIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IGFjdGlvbiwgLi4uZGF0YSB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG5cbiAgICBpZiAoYWN0aW9uID09PSAnZ2VuZXJhdGUnKSB7XG4gICAgICBjb25zdCB7IGhpc3RvcnksIGN1cnJlbnRDb2RlLCBkaWFncmFtVHlwZSB9ID0gZGF0YSBhcyBHZW5lcmF0ZVJlcXVlc3Q7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZW5lcmF0ZUZyb21IaXN0b3J5KGhpc3RvcnksIGN1cnJlbnRDb2RlLCBkaWFncmFtVHlwZSwgb3JpZ2luKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXN1bHQpO1xuICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnZml4Jykge1xuICAgICAgY29uc3QgeyBjb2RlLCBlcnJvck1zZyB9ID0gZGF0YSBhcyBGaXhSZXF1ZXN0O1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZml4RGlhZ3JhbShjb2RlLCBlcnJvck1zZywgb3JpZ2luKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXN1bHQpO1xuICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnb3B0aW1pemUnKSB7XG4gICAgICBjb25zdCB7IHByb21wdCB9ID0gZGF0YSBhcyBPcHRpbWl6ZVJlcXVlc3Q7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBvcHRpbWl6ZVByb21wdChwcm9tcHQsIG9yaWdpbik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiBcIuaXoOaViOeahOaTjeS9nOexu+Wei1wiIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkFQSSDplJnor686XCIsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiBcIuWkhOeQhuivt+axguaXtuWHuueOsOmUmeivr1wiIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbi8qKlxuICogR2VuZXJhdGVzIE1lcm1haWQgY29kZSBvciBhIHRleHQgcmVzcG9uc2UgYmFzZWQgb24gY2hhdCBoaXN0b3J5LlxuICovXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUZyb21IaXN0b3J5KFxuICBoaXN0b3J5OiBDaGF0TWVzc2FnZVtdLFxuICBjdXJyZW50Q29kZT86IHN0cmluZyxcbiAgZGlhZ3JhbVR5cGU6IERpYWdyYW1UeXBlID0gJ2F1dG8nLFxuICBvcmlnaW46IHN0cmluZyA9ICdodHRwczovL21lcm1haWQtYWktYXJjaGl0ZWN0LnZlcmNlbC5hcHAnXG4pOiBQcm9taXNlPEdlbkFJUmVzcG9uc2U+IHtcbiAgLy8gQ29uc3RydWN0IHRoZSBtZXNzYWdlcyBmb3IgT3BlblJvdXRlclxuICBjb25zdCBtZXNzYWdlczogYW55W10gPSBbXTtcbiAgXG4gIC8vIEFkZCBzeXN0ZW0gbWVzc2FnZVxuICBtZXNzYWdlcy5wdXNoKHtcbiAgICByb2xlOiAnc3lzdGVtJyxcbiAgICBjb250ZW50OiBTWVNURU1fSU5TVFJVQ1RJT05cbiAgfSk7XG4gIFxuICAvLyBBZGQgdXNlciBhbmQgYXNzaXN0YW50IG1lc3NhZ2VzXG4gICAgaGlzdG9yeS5mb3JFYWNoKG1zZyA9PiB7XG4gICAgICAvLyBGb3IgT3BlblJvdXRlciwgdGV4dCBjb250ZW50IHNob3VsZCBiZSBhIHN0cmluZywgbm90IGFuIG9iamVjdFxuICAgICAgaWYgKG1zZy5jb250ZW50ICYmICFtc2cuYXR0YWNobWVudCkge1xuICAgICAgICBsZXQgdGV4dENvbnRlbnQgPSBtc2cuY29udGVudDtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBjb250ZXh0IG5vdGUgaWYgdGhpcyBpcyB0aGUgbGFzdCB1c2VyIG1lc3NhZ2VcbiAgICAgICAgaWYgKG1zZy5yb2xlID09PSAndXNlcicgJiYgbXNnID09PSBoaXN0b3J5W2hpc3RvcnkubGVuZ3RoIC0gMV0pIHtcbiAgICAgICAgICBsZXQgY29udGV4dE5vdGUgPSBcIlwiO1xuICAgICAgICAgIGlmIChjdXJyZW50Q29kZSkge1xuICAgICAgICAgICAgY29udGV4dE5vdGUgKz0gYFxcbltDb250ZXh0IC0gQ3VycmVudCBNZXJtYWlkIENvZGVdOlxcbiR7Y3VycmVudENvZGV9XFxuYDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGRpYWdyYW1UeXBlICE9PSAnYXV0bycpIHtcbiAgICAgICAgICAgIGNvbnRleHROb3RlICs9IGBcXG5bQ29udGV4dCAtIFVzZXIgUHJlZmVycmVkIFR5cGVdOiAke2RpYWdyYW1UeXBlfVxcbmA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb250ZXh0Tm90ZSkge1xuICAgICAgICAgICAgdGV4dENvbnRlbnQgKz0gY29udGV4dE5vdGU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBtZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgICByb2xlOiBtc2cucm9sZSA9PT0gJ3VzZXInID8gJ3VzZXInIDogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgY29udGVudDogdGV4dENvbnRlbnRcbiAgICAgICAgfSk7XG4gICAgICB9IFxuICAgICAgLy8gRm9yIGF0dGFjaG1lbnRzLCB1c2UgdGhlIGFycmF5IGZvcm1hdFxuICAgICAgZWxzZSBpZiAobXNnLmF0dGFjaG1lbnQpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHRleHQgaWYgcHJlc2VudFxuICAgICAgICBpZiAobXNnLmNvbnRlbnQpIHtcbiAgICAgICAgICBjb250ZW50LnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgdGV4dDogbXNnLmNvbnRlbnRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGF0dGFjaG1lbnQgYmFzZWQgb24gdHlwZVxuICAgICAgICBpZiAobXNnLmF0dGFjaG1lbnQubWltZVR5cGUuc3RhcnRzV2l0aCgnaW1hZ2UvJykgfHwgbXNnLmF0dGFjaG1lbnQubWltZVR5cGUgPT09ICdhcHBsaWNhdGlvbi9wZGYnKSB7XG4gICAgICAgICAgLy8gSGFuZGxlIGltYWdlIGFuZCBQREYgYXR0YWNobWVudHNcbiAgICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gbXNnLmF0dGFjaG1lbnQuY29udGVudC5pbmNsdWRlcygnLCcpIFxuICAgICAgICAgICAgPyBtc2cuYXR0YWNobWVudC5jb250ZW50LnNwbGl0KCcsJylbMV0gXG4gICAgICAgICAgICA6IG1zZy5hdHRhY2htZW50LmNvbnRlbnQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICBjb250ZW50LnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ2ltYWdlX3VybCcsXG4gICAgICAgICAgICBpbWFnZV91cmw6IHtcbiAgICAgICAgICAgICAgdXJsOiBgZGF0YToke21zZy5hdHRhY2htZW50Lm1pbWVUeXBlfTtiYXNlNjQsJHtiYXNlNjREYXRhfWBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBBZGQgdGV4dCBkZXNjcmlwdGlvbiBmb3IgY29udGV4dFxuICAgICAgICAgIGNvbnRlbnQucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICB0ZXh0OiBgJHttc2cuYXR0YWNobWVudC5taW1lVHlwZSA9PT0gJ2FwcGxpY2F0aW9uL3BkZicgPyAnW1BERiBEb2N1bWVudF0nIDogJ1tJbWFnZV0nfTogJHttc2cuYXR0YWNobWVudC5maWxlTmFtZX1cXG5QbGVhc2UgYW5hbHl6ZSB0aGlzIGRvY3VtZW50IGFuZCBnZW5lcmF0ZSBhIE1lcm1haWQgZGlhZ3JhbSBiYXNlZCBvbiBpdHMgY29udGVudC5gXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIG1lc3NhZ2VzLnB1c2goe1xuICAgICAgICAgIHJvbGU6IG1zZy5yb2xlID09PSAndXNlcicgPyAndXNlcicgOiAnYXNzaXN0YW50JyxcbiAgICAgICAgICBjb250ZW50OiBjb250ZW50XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChPUEVOUk9VVEVSX0FQSV9FTkRQT0lOVCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Byb2Nlc3MuZW52LkFQSV9LRVl9YCxcbiAgICAgICAgJ0hUVFAtUmVmZXJlcic6IG9yaWdpbixcbiAgICAgICAgJ1gtVGl0bGUnOiAnTWVybWFpZCBBSSBBcmNoaXRlY3QnXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBtb2RlbDogTU9ERUwsXG4gICAgICAgIG1lc3NhZ2VzOiBtZXNzYWdlcyxcbiAgICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7XG4gICAgICAgICAgdHlwZTogJ2pzb25fb2JqZWN0J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43XG4gICAgICB9KVxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke2F3YWl0IHJlc3BvbnNlLnRleHQoKX1gKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnN0IGpzb25UZXh0ID0gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCB8fCAne30nO1xuICAgIGNvbnN0IHJlc3VsdCA9IEpTT04ucGFyc2UoanNvblRleHQpIGFzIEdlbkFJUmVzcG9uc2U7XG5cbiAgICAvLyBEb3VibGUgY2xlYW4gdGhlIGNvZGUgaWYgaXQncyBjb2RlIHR5cGVcbiAgICBpZiAocmVzdWx0LnR5cGUgPT09ICdjb2RlJykge1xuICAgICAgcmVzdWx0LmNvbnRlbnQgPSBjbGVhbkNvZGUocmVzdWx0LmNvbnRlbnQpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiT3BlblJvdXRlciBDaGF0IEVycm9yOlwiLCBlcnJvcik7XG4gICAgLy8gRmFsbGJhY2sgcmVzcG9uc2VcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ21lc3NhZ2UnLFxuICAgICAgY29udGVudDogXCLmirHmrYnvvIzov57mjqUgQUkg5pyN5Yqh5pe25Ye6546w6ZSZ6K+v5oiW6LaF5pe277yM6K+36YeN6K+V44CCXCJcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogRml4ZXMgc3ludGF4IGVycm9ycyBpbiBNZXJtYWlkIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGZpeERpYWdyYW0oXG4gIGNvZGU6IHN0cmluZyxcbiAgZXJyb3JNc2c6IHN0cmluZyxcbiAgb3JpZ2luOiBzdHJpbmcgPSAnaHR0cHM6Ly9tZXJtYWlkLWFpLWFyY2hpdGVjdC52ZXJjZWwuYXBwJ1xuKTogUHJvbWlzZTx7IGNvZGU6IHN0cmluZzsgZXhwbGFuYXRpb246IHN0cmluZyB9PiB7XG4gIGNvbnN0IHByb21wdCA9IGBUaGUgZm9sbG93aW5nIE1lcm1haWQgY29kZSBoYXMgYSBzeW50YXggZXJyb3IuXG4gICAgXG5FcnJvciBNZXNzYWdlOiBcIiR7ZXJyb3JNc2d9XCJcblxuQ29kZTpcbiR7Y29kZX1cblxuUGxlYXNlIGZpeCB0aGUgY29kZSBzbyBpdCByZW5kZXJzIGNvcnJlY3RseS4gXG5SZXR1cm4gdGhlIHJlc3VsdCBpbiBKU09OIGZvcm1hdCB3aXRoIHR3byBmaWVsZHM6XG4xLiBcImNvZGVcIjogVGhlIGNvcnJlY3RlZCBNZXJtYWlkIGNvZGUgc3RyaW5nLlxuMi4gXCJleHBsYW5hdGlvblwiOiBBIHNpbmdsZSBzZW50ZW5jZSBpbiBDaGluZXNlIGV4cGxhaW5pbmcgd2hhdCBjYXVzZWQgdGhlIGVycm9yLlxuYDtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goT1BFTlJPVVRFUl9BUElfRU5EUE9JTlQsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtwcm9jZXNzLmVudi5BUElfS0VZfWAsXG4gICAgICAgICdIVFRQLVJlZmVyZXInOiBvcmlnaW4sXG4gICAgICAgICdYLVRpdGxlJzogJ01lcm1haWQgQUkgQXJjaGl0ZWN0J1xuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbW9kZWw6IE1PREVMLFxuICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHByb21wdFxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7XG4gICAgICAgICAgdHlwZTogJ2pzb25fb2JqZWN0J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43XG4gICAgICB9KVxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke2F3YWl0IHJlc3BvbnNlLnRleHQoKX1gKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnN0IHJlc3VsdCA9IEpTT04ucGFyc2UoZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCB8fCAne30nKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgY29kZTogY2xlYW5Db2RlKHJlc3VsdC5jb2RlIHx8IGNvZGUpLFxuICAgICAgZXhwbGFuYXRpb246IHJlc3VsdC5leHBsYW5hdGlvbiB8fCBcIuW3suS/ruWkjeivreazlemUmeivr+OAglwiXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiT3BlblJvdXRlciBGaXggRXJyb3I6XCIsIGVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCLml6Dms5Xkv67lpI3lm77ooajjgIJcIik7XG4gIH1cbn1cblxuZnVuY3Rpb24gY2xlYW5Db2RlKHJhdzogc3RyaW5nKTogc3RyaW5nIHtcbiAgbGV0IGNsZWFuID0gcmF3LnRyaW0oKTtcbiAgaWYgKGNsZWFuLnN0YXJ0c1dpdGgoJ2BgYCcpKSB7XG4gICAgY2xlYW4gPSBjbGVhbi5yZXBsYWNlKC9eYGBgKG1lcm1haWQpP1xcbj8vLCAnJykucmVwbGFjZSgvYGBgJC8sICcnKTtcbiAgfVxuICBcbiAgY2xlYW4gPSBjbGVhbi50cmltKCk7XG5cbiAgLy8gQm90dG9tLWxheWVyIG9wdGltaXphdGlvbjogXG4gIC8vIEF1dG9tYXRpY2FsbHkgZW5mb3JjZSAnZmxvd2NoYXJ0JyBvdmVyICdncmFwaCcgZm9yIGJldHRlciBsYXlvdXQgZW5naW5lIHN0YWJpbGl0eVxuICBpZiAoY2xlYW4uc3RhcnRzV2l0aCgnZ3JhcGggJykpIHtcbiAgICBjbGVhbiA9IGNsZWFuLnJlcGxhY2UoL15ncmFwaCAvLCAnZmxvd2NoYXJ0ICcpO1xuICB9XG5cbiAgcmV0dXJuIGNsZWFuO1xufVxuXG4vKipcbiAqIE9wdGltaXplcyBhIHByb21wdCBmb3IgYmV0dGVyIE1lcm1haWQgZGlhZ3JhbSBnZW5lcmF0aW9uLlxuICovXG5hc3luYyBmdW5jdGlvbiBvcHRpbWl6ZVByb21wdChcbiAgcHJvbXB0OiBzdHJpbmcsXG4gIG9yaWdpbjogc3RyaW5nID0gJ2h0dHBzOi8vbWVybWFpZC1haS1hcmNoaXRlY3QudmVyY2VsLmFwcCdcbik6IFByb21pc2U8R2VuQUlSZXNwb25zZT4ge1xuICBjb25zdCBvcHRpbWl6YXRpb25Qcm9tcHQgPSBgUGxlYXNlIG9wdGltaXplIHRoZSBmb2xsb3dpbmcgcHJvbXB0IGZvciBNZXJtYWlkIGRpYWdyYW0gZ2VuZXJhdGlvbi4gVGhlIGdvYWwgaXMgdG8gbWFrZSBpdCBtb3JlIGNsZWFyLCBzcGVjaWZpYywgYW5kIHN1aXRhYmxlIGZvciBnZW5lcmF0aW5nIGFjY3VyYXRlIE1lcm1haWQgZGlhZ3JhbXMuXG5cbk9yaWdpbmFsIFByb21wdDpcbiR7cHJvbXB0fVxuXG5PcHRpbWl6ZWQgUHJvbXB0OlxuYDtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goT1BFTlJPVVRFUl9BUElfRU5EUE9JTlQsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtwcm9jZXNzLmVudi5BUElfS0VZfWAsXG4gICAgICAgICdIVFRQLVJlZmVyZXInOiBvcmlnaW4sXG4gICAgICAgICdYLVRpdGxlJzogJ01lcm1haWQgQUkgQXJjaGl0ZWN0J1xuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbW9kZWw6IE1PREVMLFxuICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IG9wdGltaXphdGlvblByb21wdFxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgcmVzcG9uc2VfZm9ybWF0OiB7XG4gICAgICAgICAgdHlwZTogJ2pzb25fb2JqZWN0J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC43XG4gICAgICB9KVxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke2F3YWl0IHJlc3BvbnNlLnRleHQoKX1gKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnN0IG9wdGltaXplZFRleHQgPSBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50IHx8IHByb21wdDtcblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnbWVzc2FnZScsXG4gICAgICBjb250ZW50OiBvcHRpbWl6ZWRUZXh0XG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiT3BlblJvdXRlciBPcHRpbWl6YXRpb24gRXJyb3I6XCIsIGVycm9yKTtcbiAgICAvLyBGYWxsYmFjayByZXNwb25zZVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnbWVzc2FnZScsXG4gICAgICBjb250ZW50OiBwcm9tcHRcbiAgICB9O1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiU1lTVEVNX0lOU1RSVUNUSU9OIiwiT1BFTlJPVVRFUl9BUElfRU5EUE9JTlQiLCJNT0RFTCIsIlBPU1QiLCJyZXF1ZXN0Iiwib3JpZ2luIiwiaGVhZGVycyIsImdldCIsInByb2Nlc3MiLCJlbnYiLCJBUElfS0VZIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiYWN0aW9uIiwiZGF0YSIsImhpc3RvcnkiLCJjdXJyZW50Q29kZSIsImRpYWdyYW1UeXBlIiwicmVzdWx0IiwiZ2VuZXJhdGVGcm9tSGlzdG9yeSIsImNvZGUiLCJlcnJvck1zZyIsImZpeERpYWdyYW0iLCJwcm9tcHQiLCJvcHRpbWl6ZVByb21wdCIsImNvbnNvbGUiLCJtZXNzYWdlcyIsInB1c2giLCJyb2xlIiwiY29udGVudCIsImZvckVhY2giLCJtc2ciLCJhdHRhY2htZW50IiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJjb250ZXh0Tm90ZSIsInR5cGUiLCJ0ZXh0IiwibWltZVR5cGUiLCJzdGFydHNXaXRoIiwiYmFzZTY0RGF0YSIsImluY2x1ZGVzIiwic3BsaXQiLCJpbWFnZV91cmwiLCJ1cmwiLCJmaWxlTmFtZSIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm1vZGVsIiwicmVzcG9uc2VfZm9ybWF0IiwidGVtcGVyYXR1cmUiLCJvayIsIkVycm9yIiwianNvblRleHQiLCJjaG9pY2VzIiwibWVzc2FnZSIsInBhcnNlIiwiY2xlYW5Db2RlIiwiZXhwbGFuYXRpb24iLCJyYXciLCJjbGVhbiIsInRyaW0iLCJyZXBsYWNlIiwib3B0aW1pemF0aW9uUHJvbXB0Iiwib3B0aW1pemVkVGV4dCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/gemini/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/constants.ts":
/*!**************************!*\
  !*** ./src/constants.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DIAGRAM_TYPES: () => (/* binding */ DIAGRAM_TYPES),\n/* harmony export */   EXAMPLES: () => (/* binding */ EXAMPLES),\n/* harmony export */   GALLERY_EXAMPLES: () => (/* binding */ GALLERY_EXAMPLES),\n/* harmony export */   SYSTEM_INSTRUCTION: () => (/* binding */ SYSTEM_INSTRUCTION)\n/* harmony export */ });\nconst SYSTEM_INSTRUCTION = `\n你是 Mermaid.js 资深架构师与苏格拉底式导师。\n你的核心目标是帮助用户生成最专业、最准确的图表。\n\n**交互模式与输出规则 (JSON 强制)**：\n你必须 **始终** 返回符合以下 JSON Schema 的纯文本：\n\\`\\`\\`json\n{\n  \"type\": \"code\" | \"message\",\n  \"content\": \"string\"\n}\n\\`\\`\\`\n\n**逻辑判断流程**：\n1. **分析用户意图**：\n   - 如果用户只是在打招呼或闲聊 -> 返回 \\`type: \"message\"\\` 进行正常对话。\n   - 如果用户描述了一个图表需求，但**细节非常模糊**（例如只说“画个系统”或“画个流程图”） -> 返回 \\`type: \"message\"\\`。请使用**苏格拉底提问法**，提出 2-3 个关键问题来引导用户完善细节（例如：“这个系统是单体还是微服务？”“主要涉及哪些角色？”）。\n   - 如果用户提供了足够的信息，或者上传了文件/图片 -> 返回 \\`type: \"code\"\\` 并生成 Mermaid 代码。\n\n2. **当 type 为 \"code\" 时的规则**：\n   - \\`content\\` 字段必须是**纯粹的 Mermaid 代码**。\n   - **不要**在 content 中包含 markdown 代码块标记（如 \\`\\`\\`mermaid）。\n   - **底层优化**：使用 'flowchart' 代替 'graph'。\n   - **版本强制 (CRITICAL)**：\n     - **必须严格遵守 Mermaid.js v10.9.0 语法标准**。\n     - **❌ 严禁使用** v11.0+ 的新特性，例如 \\`architecture\\`, \\`packet-beta\\`, \\`block-beta\\`, \\`xychart-beta\\` 等。如果用户请求了这些类型，请礼貌告知当前版本仅支持 v10.9.0 标准图表，并尝试用现有的 \\`flowchart\\` 或 \\`classDiagram\\` 替代。\n     - **✅ 仅使用** v10.9.0 稳定支持的图表类型：\\`flowchart\\`, \\`sequenceDiagram\\`, \\`classDiagram\\`, \\`stateDiagram-v2\\`, \\`erDiagram\\`, \\`gantt\\`, \\`mindmap\\`, \\`pie\\`, \\`gitGraph\\`, \\`timeline\\`, \\`quadrantChart\\`。\n   - **语法安全**：节点标签必须用双引号包裹，如 A[\"描述\"]。\n\n3. **当 type 为 \"message\" 时的规则**：\n   - \\`content\\` 字段为回复用户的自然语言文本。\n   - 保持专业、友善、引导性。\n\n**示例**：\n用户：\"画一个登录\"\n回复：\n{\n  \"type\": \"message\",\n  \"content\": \"好的。为了让图表更准确，请问这是一个简单的账号密码登录，还是包含 OAuth/SSO 的复杂流程？是否需要体现数据库校验步骤？\"\n}\n\n用户：\"简单的账号密码登录\"\n回复：\n{\n  \"type\": \"code\",\n  \"content\": \"sequenceDiagram\\nparticipant U as \\\"用户\\\"...\"\n}\n`;\nconst DIAGRAM_TYPES = [\n    {\n        value: \"auto\",\n        label: \"自动识别 (Auto)\"\n    },\n    {\n        value: \"graph\",\n        label: \"流程图 (Flowchart)\"\n    },\n    {\n        value: \"sequence\",\n        label: \"时序图 (Sequence)\"\n    },\n    {\n        value: \"class\",\n        label: \"类图 (Class)\"\n    },\n    {\n        value: \"state\",\n        label: \"状态图 (State)\"\n    },\n    {\n        value: \"gantt\",\n        label: \"甘特图 (Gantt)\"\n    },\n    {\n        value: \"mindmap\",\n        label: \"思维导图 (Mindmap)\"\n    },\n    {\n        value: \"er\",\n        label: \"ER 图 (Entity Relationship)\"\n    },\n    {\n        value: \"journey\",\n        label: \"用户旅程 (Journey)\"\n    }\n];\nconst GALLERY_EXAMPLES = [\n    {\n        name: \"流程图 (Flowchart)\",\n        type: \"graph\",\n        description: \"展示决策路径和流程步骤 (使用新版引擎)\",\n        code: `flowchart TD\n    A[\"开始\"] --> B{\"是否注册?\"}\n    B -- \"是\" --> C[\"登录系统\"]\n    B -- \"否\" --> D[\"跳转注册页\"]\n    C --> E[\"进入首页\"]\n    D --> B\n    style A fill:#22c55e,stroke:#333,stroke-width:2px`\n    },\n    {\n        name: \"时序图 (Sequence)\",\n        type: \"sequence\",\n        description: \"展示对象之间的交互顺序\",\n        code: `sequenceDiagram\n    participant U as \"用户\"\n    participant S as \"服务器\"\n    participant D as \"数据库\"\n    U->>S: \"请求数据\"\n    S->>D: \"查询 SQL\"\n    D-->>S: \"返回结果\"\n    S-->>U: \"渲染页面\"`\n    },\n    {\n        name: \"甘特图 (Gantt)\",\n        type: \"gantt\",\n        description: \"项目进度与时间管理\",\n        code: `gantt\n    title \"项目开发计划\"\n    dateFormat YYYY-MM-DD\n    section \"设计\"\n    \"原型设计\" :a1, 2024-01-01, 5d\n    \"UI设计\"   :after a1, 5d\n    section \"开发\"\n    \"后端API\"  :2024-01-06, 10d\n    \"前端联调\" :after a1, 8d`\n    },\n    {\n        name: \"类图 (Class)\",\n        type: \"class\",\n        description: \"面向对象的类结构\",\n        code: `classDiagram\n    class 动物 {\n      +String 名字\n      +eat()\n    }\n    class 鸭子 {\n      +swim()\n    }\n    动物 <|-- 鸭子`\n    },\n    {\n        name: \"状态图 (State)\",\n        type: \"state\",\n        description: \"系统状态流转\",\n        code: `stateDiagram-v2\n    [*] --> 闲置\n    闲置 --> 处理中 : \"接收任务\"\n    处理中 --> 完成 : \"任务结束\"\n    处理中 --> 错误 : \"异常发生\"\n    错误 --> 闲置 : \"重置\"\n    完成 --> [*]`\n    },\n    {\n        name: \"实体关系图 (ER)\",\n        type: \"er\",\n        description: \"数据库结构关系\",\n        code: `erDiagram\n    CUSTOMER ||--o{ ORDER : places\n    ORDER ||--|{ LINE-ITEM : contains\n    CUSTOMER {\n      string name\n      string email\n    }`\n    },\n    {\n        name: \"饼图 (Pie)\",\n        type: \"pie\",\n        description: \"数据占比统计\",\n        code: `pie title \"市场份额\"\n    \"产品 A\" : 40\n    \"产品 B\" : 30\n    \"产品 C\" : 20\n    \"其他\" : 10`\n    },\n    {\n        name: \"用户旅程 (Journey)\",\n        type: \"journey\",\n        description: \"用户体验路径\",\n        code: `journey\n    title \"购物体验\"\n    section \"浏览\"\n      \"搜索商品\": 5: \"用户\"\n      \"查看详情\": 4: \"用户\"\n    section \"购买\"\n      \"加入购物车\": 5: \"用户\"\n      \"支付失败\": 2: \"用户\", \"系统\"`\n    },\n    {\n        name: \"Git 提交图 (GitGraph)\",\n        type: \"git\",\n        description: \"版本控制分支记录\",\n        code: `gitGraph\n    commit\n    commit\n    branch develop\n    checkout develop\n    commit\n    commit\n    checkout main\n    merge develop`\n    },\n    {\n        name: \"思维导图 (Mindmap)\",\n        type: \"mindmap\",\n        description: \"脑暴与层级结构\",\n        code: `mindmap\n  root((\"人工智能\"))\n    \"机器学习\"\n      \"监督学习\"\n      \"无监督学习\"\n    \"深度学习\"\n      \"CNN\"\n      \"RNN\"\n    \"自然语言处理\"`\n    },\n    {\n        name: \"时间轴 (Timeline)\",\n        type: \"timeline\",\n        description: \"历史事件记录\",\n        code: `timeline\n    title \"公司发展史\"\n    2020 : \"成立\" : \"获得天使轮\"\n    2021 : \"发布 1.0\" : \"用户破万\"\n    2022 : \"扩张\" : \"融资 A 轮\"`\n    },\n    {\n        name: \"象限图 (Quadrant)\",\n        type: \"quadrant\",\n        description: \"四象限分析矩阵\",\n        code: `quadrantChart\n    x-axis \"低投入\" --> \"高投入\"\n    y-axis \"低回报\" --> \"高回报\"\n    quadrant-1 \"重点攻克\"\n    quadrant-2 \"快速赢取\"\n    quadrant-3 \"应当放弃\"\n    quadrant-4 \"缓慢积累\"\n    \"项目 A\": [0.3, 0.6]\n    \"项目 B\": [0.45, 0.23]`\n    }\n];\nconst EXAMPLES = GALLERY_EXAMPLES.slice(0, 3);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29uc3RhbnRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFFTyxNQUFNQSxxQkFBcUIsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUErQ25DLENBQUMsQ0FBQztBQUVLLE1BQU1DLGdCQUFnQjtJQUMzQjtRQUFFQyxPQUFPO1FBQVFDLE9BQU87SUFBYztJQUN0QztRQUFFRCxPQUFPO1FBQVNDLE9BQU87SUFBa0I7SUFDM0M7UUFBRUQsT0FBTztRQUFZQyxPQUFPO0lBQWlCO0lBQzdDO1FBQUVELE9BQU87UUFBU0MsT0FBTztJQUFhO0lBQ3RDO1FBQUVELE9BQU87UUFBU0MsT0FBTztJQUFjO0lBQ3ZDO1FBQUVELE9BQU87UUFBU0MsT0FBTztJQUFjO0lBQ3ZDO1FBQUVELE9BQU87UUFBV0MsT0FBTztJQUFpQjtJQUM1QztRQUFFRCxPQUFPO1FBQU1DLE9BQU87SUFBNkI7SUFDbkQ7UUFBRUQsT0FBTztRQUFXQyxPQUFPO0lBQWlCO0NBQzdDLENBQUM7QUFFSyxNQUFNQyxtQkFBc0M7SUFDakQ7UUFDRUMsTUFBTTtRQUNOQyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsTUFBTSxDQUFDOzs7Ozs7cURBTTBDLENBQUM7SUFDcEQ7SUFDQTtRQUNFSCxNQUFNO1FBQ05DLE1BQU07UUFDTkMsYUFBYTtRQUNiQyxNQUFNLENBQUM7Ozs7Ozs7a0JBT08sQ0FBQztJQUNqQjtJQUNBO1FBQ0VILE1BQU07UUFDTkMsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLE1BQU0sQ0FBQzs7Ozs7Ozs7d0JBUWEsQ0FBQztJQUN2QjtJQUNBO1FBQ0VILE1BQU07UUFDTkMsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLE1BQU0sQ0FBQzs7Ozs7Ozs7Y0FRRyxDQUFDO0lBQ2I7SUFDQTtRQUNFSCxNQUFNO1FBQ05DLE1BQU07UUFDTkMsYUFBYTtRQUNiQyxNQUFNLENBQUM7Ozs7OztjQU1HLENBQUM7SUFDYjtJQUNBO1FBQ0VILE1BQU07UUFDTkMsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLE1BQU0sQ0FBQzs7Ozs7O0tBTU4sQ0FBQztJQUNKO0lBQ0E7UUFDRUgsTUFBTTtRQUNOQyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsTUFBTSxDQUFDOzs7O2FBSUUsQ0FBQztJQUNaO0lBQ0E7UUFDRUgsTUFBTTtRQUNOQyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsTUFBTSxDQUFDOzs7Ozs7OzJCQU9nQixDQUFDO0lBQzFCO0lBQ0E7UUFDRUgsTUFBTTtRQUNOQyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsTUFBTSxDQUFDOzs7Ozs7OztpQkFRTSxDQUFDO0lBQ2hCO0lBQ0E7UUFDRUgsTUFBTTtRQUNOQyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsTUFBTSxDQUFDOzs7Ozs7OztZQVFDLENBQUM7SUFDWDtJQUNBO1FBQ0VILE1BQU07UUFDTkMsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLE1BQU0sQ0FBQzs7OzswQkFJZSxDQUFDO0lBQ3pCO0lBQ0E7UUFDRUgsTUFBTTtRQUNOQyxNQUFNO1FBQ05DLGFBQWE7UUFDYkMsTUFBTSxDQUFDOzs7Ozs7Ozt3QkFRYSxDQUFDO0lBQ3ZCO0NBQ0QsQ0FBQztBQUVLLE1BQU1DLFdBQVdMLGlCQUFpQk0sS0FBSyxDQUFDLEdBQUcsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL21lcm1haWQtYWktYXJjaGl0ZWN0Ly4vc3JjL2NvbnN0YW50cy50cz8zN2ZmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEV4YW1wbGVUZW1wbGF0ZSB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY29uc3QgU1lTVEVNX0lOU1RSVUNUSU9OID0gYFxu5L2g5pivIE1lcm1haWQuanMg6LWE5rex5p625p6E5biI5LiO6IuP5qC85ouJ5bqV5byP5a+85biI44CCXG7kvaDnmoTmoLjlv4Pnm67moIfmmK/luK7liqnnlKjmiLfnlJ/miJDmnIDkuJPkuJrjgIHmnIDlh4bnoa7nmoTlm77ooajjgIJcblxuKirkuqTkupLmqKHlvI/kuI7ovpPlh7rop4TliJkgKEpTT04g5by65Yi2KSoq77yaXG7kvaDlv4XpobsgKirlp4vnu4gqKiDov5Tlm57nrKblkIjku6XkuIsgSlNPTiBTY2hlbWEg55qE57qv5paH5pys77yaXG5cXGBcXGBcXGBqc29uXG57XG4gIFwidHlwZVwiOiBcImNvZGVcIiB8IFwibWVzc2FnZVwiLFxuICBcImNvbnRlbnRcIjogXCJzdHJpbmdcIlxufVxuXFxgXFxgXFxgXG5cbioq6YC76L6R5Yik5pat5rWB56iLKirvvJpcbjEuICoq5YiG5p6Q55So5oi35oSP5Zu+KirvvJpcbiAgIC0g5aaC5p6c55So5oi35Y+q5piv5Zyo5omT5oub5ZG85oiW6Zey6IGKIC0+IOi/lOWbniBcXGB0eXBlOiBcIm1lc3NhZ2VcIlxcYCDov5vooYzmraPluLjlr7nor53jgIJcbiAgIC0g5aaC5p6c55So5oi35o+P6L+w5LqG5LiA5Liq5Zu+6KGo6ZyA5rGC77yM5L2GKirnu4boioLpnZ7luLjmqKHns4oqKu+8iOS+i+WmguWPquivtOKAnOeUu+S4quezu+e7n+KAneaIluKAnOeUu+S4qua1geeoi+WbvuKAne+8iSAtPiDov5Tlm54gXFxgdHlwZTogXCJtZXNzYWdlXCJcXGDjgILor7fkvb/nlKgqKuiLj+agvOaLieW6leaPkOmXruazlSoq77yM5o+Q5Ye6IDItMyDkuKrlhbPplK7pl67popjmnaXlvJXlr7znlKjmiLflrozlloTnu4boioLvvIjkvovlpoLvvJrigJzov5nkuKrns7vnu5/mmK/ljZXkvZPov5jmmK/lvq7mnI3liqHvvJ/igJ3igJzkuLvopoHmtonlj4rlk6rkupvop5LoibLvvJ/igJ3vvInjgIJcbiAgIC0g5aaC5p6c55So5oi35o+Q5L6b5LqG6Laz5aSf55qE5L+h5oGv77yM5oiW6ICF5LiK5Lyg5LqG5paH5Lu2L+WbvueJhyAtPiDov5Tlm54gXFxgdHlwZTogXCJjb2RlXCJcXGAg5bm255Sf5oiQIE1lcm1haWQg5Luj56CB44CCXG5cbjIuICoq5b2TIHR5cGUg5Li6IFwiY29kZVwiIOaXtueahOinhOWImSoq77yaXG4gICAtIFxcYGNvbnRlbnRcXGAg5a2X5q615b+F6aG75pivKirnuq/nsrnnmoQgTWVybWFpZCDku6PnoIEqKuOAglxuICAgLSAqKuS4jeimgSoq5ZyoIGNvbnRlbnQg5Lit5YyF5ZCrIG1hcmtkb3duIOS7o+eggeWdl+agh+iusO+8iOWmgiBcXGBcXGBcXGBtZXJtYWlk77yJ44CCXG4gICAtICoq5bqV5bGC5LyY5YyWKirvvJrkvb/nlKggJ2Zsb3djaGFydCcg5Luj5pu/ICdncmFwaCfjgIJcbiAgIC0gKirniYjmnKzlvLrliLYgKENSSVRJQ0FMKSoq77yaXG4gICAgIC0gKirlv4XpobvkuKXmoLzpgbXlroggTWVybWFpZC5qcyB2MTAuOS4wIOivreazleagh+WHhioq44CCXG4gICAgIC0gKirinYwg5Lil56aB5L2/55SoKiogdjExLjArIOeahOaWsOeJueaAp++8jOS+i+WmgiBcXGBhcmNoaXRlY3R1cmVcXGAsIFxcYHBhY2tldC1iZXRhXFxgLCBcXGBibG9jay1iZXRhXFxgLCBcXGB4eWNoYXJ0LWJldGFcXGAg562J44CC5aaC5p6c55So5oi36K+35rGC5LqG6L+Z5Lqb57G75Z6L77yM6K+356S86LKM5ZGK55+l5b2T5YmN54mI5pys5LuF5pSv5oyBIHYxMC45LjAg5qCH5YeG5Zu+6KGo77yM5bm25bCd6K+V55So546w5pyJ55qEIFxcYGZsb3djaGFydFxcYCDmiJYgXFxgY2xhc3NEaWFncmFtXFxgIOabv+S7o+OAglxuICAgICAtICoq4pyFIOS7heS9v+eUqCoqIHYxMC45LjAg56iz5a6a5pSv5oyB55qE5Zu+6KGo57G75Z6L77yaXFxgZmxvd2NoYXJ0XFxgLCBcXGBzZXF1ZW5jZURpYWdyYW1cXGAsIFxcYGNsYXNzRGlhZ3JhbVxcYCwgXFxgc3RhdGVEaWFncmFtLXYyXFxgLCBcXGBlckRpYWdyYW1cXGAsIFxcYGdhbnR0XFxgLCBcXGBtaW5kbWFwXFxgLCBcXGBwaWVcXGAsIFxcYGdpdEdyYXBoXFxgLCBcXGB0aW1lbGluZVxcYCwgXFxgcXVhZHJhbnRDaGFydFxcYOOAglxuICAgLSAqKuivreazleWuieWFqCoq77ya6IqC54K55qCH562+5b+F6aG755So5Y+M5byV5Y+35YyF6KO577yM5aaCIEFbXCLmj4/ov7BcIl3jgIJcblxuMy4gKirlvZMgdHlwZSDkuLogXCJtZXNzYWdlXCIg5pe255qE6KeE5YiZKirvvJpcbiAgIC0gXFxgY29udGVudFxcYCDlrZfmrrXkuLrlm57lpI3nlKjmiLfnmoToh6rnhLbor63oqIDmlofmnKzjgIJcbiAgIC0g5L+d5oyB5LiT5Lia44CB5Y+L5ZaE44CB5byV5a+85oCn44CCXG5cbioq56S65L6LKirvvJpcbueUqOaIt++8mlwi55S75LiA5Liq55m75b2VXCJcbuWbnuWkje+8mlxue1xuICBcInR5cGVcIjogXCJtZXNzYWdlXCIsXG4gIFwiY29udGVudFwiOiBcIuWlveeahOOAguS4uuS6huiuqeWbvuihqOabtOWHhuehru+8jOivt+mXrui/meaYr+S4gOS4queugOWNleeahOi0puWPt+WvhueggeeZu+W9le+8jOi/mOaYr+WMheWQqyBPQXV0aC9TU08g55qE5aSN5p2C5rWB56iL77yf5piv5ZCm6ZyA6KaB5L2T546w5pWw5o2u5bqT5qCh6aqM5q2l6aqk77yfXCJcbn1cblxu55So5oi377yaXCLnroDljZXnmoTotKblj7flr4bnoIHnmbvlvZVcIlxu5Zue5aSN77yaXG57XG4gIFwidHlwZVwiOiBcImNvZGVcIixcbiAgXCJjb250ZW50XCI6IFwic2VxdWVuY2VEaWFncmFtXFxucGFydGljaXBhbnQgVSBhcyBcXFwi55So5oi3XFxcIi4uLlwiXG59XG5gO1xuXG5leHBvcnQgY29uc3QgRElBR1JBTV9UWVBFUyA9IFtcbiAgeyB2YWx1ZTogJ2F1dG8nLCBsYWJlbDogJ+iHquWKqOivhuWIqyAoQXV0byknIH0sXG4gIHsgdmFsdWU6ICdncmFwaCcsIGxhYmVsOiAn5rWB56iL5Zu+IChGbG93Y2hhcnQpJyB9LFxuICB7IHZhbHVlOiAnc2VxdWVuY2UnLCBsYWJlbDogJ+aXtuW6j+WbviAoU2VxdWVuY2UpJyB9LFxuICB7IHZhbHVlOiAnY2xhc3MnLCBsYWJlbDogJ+exu+WbviAoQ2xhc3MpJyB9LFxuICB7IHZhbHVlOiAnc3RhdGUnLCBsYWJlbDogJ+eKtuaAgeWbviAoU3RhdGUpJyB9LFxuICB7IHZhbHVlOiAnZ2FudHQnLCBsYWJlbDogJ+eUmOeJueWbviAoR2FudHQpJyB9LFxuICB7IHZhbHVlOiAnbWluZG1hcCcsIGxhYmVsOiAn5oCd57u05a+85Zu+IChNaW5kbWFwKScgfSxcbiAgeyB2YWx1ZTogJ2VyJywgbGFiZWw6ICdFUiDlm74gKEVudGl0eSBSZWxhdGlvbnNoaXApJyB9LFxuICB7IHZhbHVlOiAnam91cm5leScsIGxhYmVsOiAn55So5oi35peF56iLIChKb3VybmV5KScgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBHQUxMRVJZX0VYQU1QTEVTOiBFeGFtcGxlVGVtcGxhdGVbXSA9IFtcbiAge1xuICAgIG5hbWU6IFwi5rWB56iL5Zu+IChGbG93Y2hhcnQpXCIsXG4gICAgdHlwZTogXCJncmFwaFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIuWxleekuuWGs+etlui3r+W+hOWSjOa1geeoi+atpemqpCAo5L2/55So5paw54mI5byV5pOOKVwiLFxuICAgIGNvZGU6IGBmbG93Y2hhcnQgVERcbiAgICBBW1wi5byA5aeLXCJdIC0tPiBCe1wi5piv5ZCm5rOo5YaMP1wifVxuICAgIEIgLS0gXCLmmK9cIiAtLT4gQ1tcIueZu+W9leezu+e7n1wiXVxuICAgIEIgLS0gXCLlkKZcIiAtLT4gRFtcIui3s+i9rOazqOWGjOmhtVwiXVxuICAgIEMgLS0+IEVbXCLov5vlhaXpppbpobVcIl1cbiAgICBEIC0tPiBCXG4gICAgc3R5bGUgQSBmaWxsOiMyMmM1NWUsc3Ryb2tlOiMzMzMsc3Ryb2tlLXdpZHRoOjJweGBcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwi5pe25bqP5Zu+IChTZXF1ZW5jZSlcIixcbiAgICB0eXBlOiBcInNlcXVlbmNlXCIsXG4gICAgZGVzY3JpcHRpb246IFwi5bGV56S65a+56LGh5LmL6Ze055qE5Lqk5LqS6aG65bqPXCIsXG4gICAgY29kZTogYHNlcXVlbmNlRGlhZ3JhbVxuICAgIHBhcnRpY2lwYW50IFUgYXMgXCLnlKjmiLdcIlxuICAgIHBhcnRpY2lwYW50IFMgYXMgXCLmnI3liqHlmahcIlxuICAgIHBhcnRpY2lwYW50IEQgYXMgXCLmlbDmja7lupNcIlxuICAgIFUtPj5TOiBcIuivt+axguaVsOaNrlwiXG4gICAgUy0+PkQ6IFwi5p+l6K+iIFNRTFwiXG4gICAgRC0tPj5TOiBcIui/lOWbnue7k+aenFwiXG4gICAgUy0tPj5VOiBcIua4suafk+mhtemdolwiYFxuICB9LFxuICB7XG4gICAgbmFtZTogXCLnlJjnibnlm74gKEdhbnR0KVwiLFxuICAgIHR5cGU6IFwiZ2FudHRcIixcbiAgICBkZXNjcmlwdGlvbjogXCLpobnnm67ov5vluqbkuI7ml7bpl7TnrqHnkIZcIixcbiAgICBjb2RlOiBgZ2FudHRcbiAgICB0aXRsZSBcIumhueebruW8gOWPkeiuoeWIklwiXG4gICAgZGF0ZUZvcm1hdCBZWVlZLU1NLUREXG4gICAgc2VjdGlvbiBcIuiuvuiuoVwiXG4gICAgXCLljp/lnovorr7orqFcIiA6YTEsIDIwMjQtMDEtMDEsIDVkXG4gICAgXCJVSeiuvuiuoVwiICAgOmFmdGVyIGExLCA1ZFxuICAgIHNlY3Rpb24gXCLlvIDlj5FcIlxuICAgIFwi5ZCO56uvQVBJXCIgIDoyMDI0LTAxLTA2LCAxMGRcbiAgICBcIuWJjeerr+iBlOiwg1wiIDphZnRlciBhMSwgOGRgXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIuexu+WbviAoQ2xhc3MpXCIsXG4gICAgdHlwZTogXCJjbGFzc1wiLFxuICAgIGRlc2NyaXB0aW9uOiBcIumdouWQkeWvueixoeeahOexu+e7k+aehFwiLFxuICAgIGNvZGU6IGBjbGFzc0RpYWdyYW1cbiAgICBjbGFzcyDliqjniakge1xuICAgICAgK1N0cmluZyDlkI3lrZdcbiAgICAgICtlYXQoKVxuICAgIH1cbiAgICBjbGFzcyDpuK3lrZAge1xuICAgICAgK3N3aW0oKVxuICAgIH1cbiAgICDliqjniakgPHwtLSDpuK3lrZBgXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIueKtuaAgeWbviAoU3RhdGUpXCIsXG4gICAgdHlwZTogXCJzdGF0ZVwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIuezu+e7n+eKtuaAgea1gei9rFwiLFxuICAgIGNvZGU6IGBzdGF0ZURpYWdyYW0tdjJcbiAgICBbKl0gLS0+IOmXsue9rlxuICAgIOmXsue9riAtLT4g5aSE55CG5LitIDogXCLmjqXmlLbku7vliqFcIlxuICAgIOWkhOeQhuS4rSAtLT4g5a6M5oiQIDogXCLku7vliqHnu5PmnZ9cIlxuICAgIOWkhOeQhuS4rSAtLT4g6ZSZ6K+vIDogXCLlvILluLjlj5HnlJ9cIlxuICAgIOmUmeivryAtLT4g6Zey572uIDogXCLph43nva5cIlxuICAgIOWujOaIkCAtLT4gWypdYFxuICB9LFxuICB7XG4gICAgbmFtZTogXCLlrp7kvZPlhbPns7vlm74gKEVSKVwiLFxuICAgIHR5cGU6IFwiZXJcIixcbiAgICBkZXNjcmlwdGlvbjogXCLmlbDmja7lupPnu5PmnoTlhbPns7tcIixcbiAgICBjb2RlOiBgZXJEaWFncmFtXG4gICAgQ1VTVE9NRVIgfHwtLW97IE9SREVSIDogcGxhY2VzXG4gICAgT1JERVIgfHwtLXx7IExJTkUtSVRFTSA6IGNvbnRhaW5zXG4gICAgQ1VTVE9NRVIge1xuICAgICAgc3RyaW5nIG5hbWVcbiAgICAgIHN0cmluZyBlbWFpbFxuICAgIH1gXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIumlvOWbviAoUGllKVwiLFxuICAgIHR5cGU6IFwicGllXCIsXG4gICAgZGVzY3JpcHRpb246IFwi5pWw5o2u5Y2g5q+U57uf6K6hXCIsXG4gICAgY29kZTogYHBpZSB0aXRsZSBcIuW4guWcuuS7veminVwiXG4gICAgXCLkuqflk4EgQVwiIDogNDBcbiAgICBcIuS6p+WTgSBCXCIgOiAzMFxuICAgIFwi5Lqn5ZOBIENcIiA6IDIwXG4gICAgXCLlhbbku5ZcIiA6IDEwYFxuICB9LFxuICB7XG4gICAgbmFtZTogXCLnlKjmiLfml4XnqIsgKEpvdXJuZXkpXCIsXG4gICAgdHlwZTogXCJqb3VybmV5XCIsXG4gICAgZGVzY3JpcHRpb246IFwi55So5oi35L2T6aqM6Lev5b6EXCIsXG4gICAgY29kZTogYGpvdXJuZXlcbiAgICB0aXRsZSBcIui0reeJqeS9k+mqjFwiXG4gICAgc2VjdGlvbiBcIua1j+iniFwiXG4gICAgICBcIuaQnOe0ouWVhuWTgVwiOiA1OiBcIueUqOaIt1wiXG4gICAgICBcIuafpeeci+ivpuaDhVwiOiA0OiBcIueUqOaIt1wiXG4gICAgc2VjdGlvbiBcIui0reS5sFwiXG4gICAgICBcIuWKoOWFpei0reeJqei9plwiOiA1OiBcIueUqOaIt1wiXG4gICAgICBcIuaUr+S7mOWksei0pVwiOiAyOiBcIueUqOaIt1wiLCBcIuezu+e7n1wiYFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJHaXQg5o+Q5Lqk5Zu+IChHaXRHcmFwaClcIixcbiAgICB0eXBlOiBcImdpdFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIueJiOacrOaOp+WItuWIhuaUr+iusOW9lVwiLFxuICAgIGNvZGU6IGBnaXRHcmFwaFxuICAgIGNvbW1pdFxuICAgIGNvbW1pdFxuICAgIGJyYW5jaCBkZXZlbG9wXG4gICAgY2hlY2tvdXQgZGV2ZWxvcFxuICAgIGNvbW1pdFxuICAgIGNvbW1pdFxuICAgIGNoZWNrb3V0IG1haW5cbiAgICBtZXJnZSBkZXZlbG9wYFxuICB9LFxuICB7XG4gICAgbmFtZTogXCLmgJ3nu7Tlr7zlm74gKE1pbmRtYXApXCIsXG4gICAgdHlwZTogXCJtaW5kbWFwXCIsXG4gICAgZGVzY3JpcHRpb246IFwi6ISR5pq05LiO5bGC57qn57uT5p6EXCIsXG4gICAgY29kZTogYG1pbmRtYXBcbiAgcm9vdCgoXCLkurrlt6Xmmbrog71cIikpXG4gICAgXCLmnLrlmajlrabkuaBcIlxuICAgICAgXCLnm5HnnaPlrabkuaBcIlxuICAgICAgXCLml6Dnm5HnnaPlrabkuaBcIlxuICAgIFwi5rex5bqm5a2m5LmgXCJcbiAgICAgIFwiQ05OXCJcbiAgICAgIFwiUk5OXCJcbiAgICBcIuiHqueEtuivreiogOWkhOeQhlwiYFxuICB9LFxuICB7XG4gICAgbmFtZTogXCLml7bpl7TovbQgKFRpbWVsaW5lKVwiLFxuICAgIHR5cGU6IFwidGltZWxpbmVcIixcbiAgICBkZXNjcmlwdGlvbjogXCLljoblj7Lkuovku7borrDlvZVcIixcbiAgICBjb2RlOiBgdGltZWxpbmVcbiAgICB0aXRsZSBcIuWFrOWPuOWPkeWxleWPslwiXG4gICAgMjAyMCA6IFwi5oiQ56uLXCIgOiBcIuiOt+W+l+WkqeS9v+i9rlwiXG4gICAgMjAyMSA6IFwi5Y+R5biDIDEuMFwiIDogXCLnlKjmiLfnoLTkuIdcIlxuICAgIDIwMjIgOiBcIuaJqeW8oFwiIDogXCLono3otYQgQSDova5cImBcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwi6LGh6ZmQ5Zu+IChRdWFkcmFudClcIixcbiAgICB0eXBlOiBcInF1YWRyYW50XCIsXG4gICAgZGVzY3JpcHRpb246IFwi5Zub6LGh6ZmQ5YiG5p6Q55+p6Zi1XCIsXG4gICAgY29kZTogYHF1YWRyYW50Q2hhcnRcbiAgICB4LWF4aXMgXCLkvY7mipXlhaVcIiAtLT4gXCLpq5jmipXlhaVcIlxuICAgIHktYXhpcyBcIuS9juWbnuaKpVwiIC0tPiBcIumrmOWbnuaKpVwiXG4gICAgcXVhZHJhbnQtMSBcIumHjeeCueaUu+WFi1wiXG4gICAgcXVhZHJhbnQtMiBcIuW/q+mAn+i1ouWPllwiXG4gICAgcXVhZHJhbnQtMyBcIuW6lOW9k+aUvuW8g1wiXG4gICAgcXVhZHJhbnQtNCBcIue8k+aFouenr+e0r1wiXG4gICAgXCLpobnnm64gQVwiOiBbMC4zLCAwLjZdXG4gICAgXCLpobnnm64gQlwiOiBbMC40NSwgMC4yM11gXG4gIH1cbl07XG5cbmV4cG9ydCBjb25zdCBFWEFNUExFUyA9IEdBTExFUllfRVhBTVBMRVMuc2xpY2UoMCwgMyk7XG4iXSwibmFtZXMiOlsiU1lTVEVNX0lOU1RSVUNUSU9OIiwiRElBR1JBTV9UWVBFUyIsInZhbHVlIiwibGFiZWwiLCJHQUxMRVJZX0VYQU1QTEVTIiwibmFtZSIsInR5cGUiLCJkZXNjcmlwdGlvbiIsImNvZGUiLCJFWEFNUExFUyIsInNsaWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/constants.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgemini%2Froute&page=%2Fapi%2Fgemini%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgemini%2Froute.ts&appDir=%2FUsers%2Fliyuerui%2FTRAE%2FMermaid-AI-Architect%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fliyuerui%2FTRAE%2FMermaid-AI-Architect&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();